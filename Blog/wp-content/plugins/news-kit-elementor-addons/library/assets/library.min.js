!function($){"use strict";var NekitLibraryTemplateHandler={sectionIndex:null,contentID:0,init:function(){window.elementor.on("preview:loaded",(function(){NekitLibraryTemplateHandler.previewLoaded(),NekitLibraryTemplateHandler.initiatePopup()}))},previewLoaded:function(){var previewIframe=window.elementor.$previewContents,libraryButton='<div id="nekit-library-btn" class="elementor-add-section-area-button" style="background:url('+libraryData.logoUrl+') no-repeat center center / contain;"></div>',elementorAddSection=$("#tmpl-elementor-add-section"),elementorAddSectionText=elementorAddSection.text();elementorAddSectionText=elementorAddSectionText.replace('<div class="elementor-add-section-drag-title',libraryButton+'<div class="elementor-add-section-drag-title'),elementorAddSection.text(elementorAddSectionText),$(previewIframe).on("click",".elementor-editor-section-settings .elementor-editor-element-add",(function(){var addNewSectionWrap=$(this).closest(".elementor-top-section").prev(".elementor-add-section"),modelID=$(this).closest(".elementor-top-section").data("model-cid");0==addNewSectionWrap.find("#nekit-library-btn").length&&setTimeout((function(){addNewSectionWrap.find(".elementor-add-new-section").prepend(libraryButton)}),110),window.elementor.elements.models.length&&$.each(window.elementor.elements.models,(function(index,model){modelID===model.cid&&(NekitLibraryTemplateHandler.sectionIndex=index)})),NekitLibraryTemplateHandler.contentID++})),NekitLibraryTemplateHandler.renderLibraryPopup(previewIframe)},renderLibraryPopup:function(previewIframe){$(previewIframe).on("click","#nekit-library-btn",(function(){var popContainer=$(this);$.ajax({method:"GET",url:libraryData.ajaxUrl,data:{action:"nekit_render_popup_modal",_wpnonce:libraryData._wpnonce},beforeSend:function(){},success:function(res){var parsedRes=JSON.parse(res),modalContainer;parsedRes.loaded&&$(document).find("#nekit-library-popup").addClass("modal-active").html(parsedRes.html).promise().done((function(){var popupContainer=$(this);popupContainer.on("click",".popup-close-trigger",(function(){var popupCloseElem=$(this);NekitLibraryTemplateHandler.endPopup(popupCloseElem)})),popupContainer.on("click",".header .templates-tabs .tab-title",(function(){var templateTab=$(this);NekitLibraryTemplateHandler.filterTemplates(templateTab)})),import_data(popupContainer)}))}})}))},initiatePopup:function(){$("body").append('<div id="nekit-library-popup"></div>')},filterTemplates:function(templateTab){var templateContentPrefix=templateTab.data("filter");templateTab.parents(".header").next().find("."+templateContentPrefix+"-tab-content").show().siblings().hide()},endPopup:function(container){container.parents("#nekit-library-popup").removeClass("modal-active")}};function import_data(container){var popupCloseElem=container.find(".popup-close-trigger");container.on("click",".template-item .insert-data",(function(){var button,demo=$(this).data("route");$.ajax({method:"POST",url:libraryData.ajaxUrl,data:{action:"nekit_import_widget_library_data",demo:demo,_wpnonce:libraryData._wpnonce},beforeSend:function(){},success:function(res){var parsedRes=JSON.parse(res);window.elementor.getPreviewView().addChildModel(parsedRes.content,{at:NekitLibraryTemplateHandler.sectionIndex}),NekitLibraryTemplateHandler.endPopup(popupCloseElem)}})}))}$(window).on("elementor:init",NekitLibraryTemplateHandler.init)}(jQuery);